<head>
  <title>wanderer</title>

  <script src="https://code.jquery.com/jquery-2.1.3.min.js"></script>
</head>

<body>
    {{#if currentUser }}
        {{> screen}}
    {{else}}
        {{> user}}
    {{/if}}
</body>

<template name="screen">
    <div class="screen">
        <!--
        <div class="biome-bg forest-bg"></div>
        <div class="player"></div>
        <div class="ground"></div>
        <div class="ground-on"></div>
        -->
        {{ currentUser.name }}
        <div class="gui">
            {{> ui}}
        </div>
    </div>

    <!--
    <script type="text/javascript">
        $(function(){

          $('.ground').css({"background-position": '0px 0px'});
          $('.ground-on').css({"background-position": '0px 0px'});
          $('#background').css({"background-position": '0px 0px'});

            $('.ground').animate({
                "background-position-x":"-15000px",
            }, 240000, 'linear');

            $('.ground-on').animate({
                "background-position-x":"-15000px",
            }, 240000, 'linear');

            $('.biome-bg').animate({
                "background-position-x":"-15000px",
            }, 880000, 'linear');

        });
    </script>
    -->
</template>

<template name="user">
    <h4>Log in</h4>
    <div>
        <input id="email" placeholder="email">
        <input id="password" placeholder="Password">
        <button id="log-in">Log in</button>
    </div>

    <h4>Create user</h4>
    <div>
        <input type="text" id="new-email" placeholder="email">
        <input type="text" id="new-password" placeholder="Password">
        <input type="text" id="new-character" placeholder="Character name">
        <button id="create-user">Create</button>
    </div>
</template>

<template name="storage">
    <h4>Inventory</h4>
    {{#each storageList}}
        <div class="storage-item" data-context="item" quantity="{{qty}}" itemId="{{id}}">
            <span>{{{el}}}</span>
            <span>x{{qty}}</span>
        </div>
    {{/each}}
</template>

<template name="ui">
    <div class="gui-main">
        {{#if camping}}
            {{> uiCamping}}
        {{/if}}

        {{#if walking}}
            {{> uiWalking}}
        {{/if}}

        {{#if town}}
            {{> uiTown}}
        {{/if}}

        {{#if battle}}
            {{> uiBattle}}
        {{/if}}

        {{#if inCombat}}
            {{> combat}}
        {{/if}}
    </div>
    <div class="float">
        <div class="left gui-window">
            {{> uiCharacter}}
        </div>
        <div class="left gui-window">
            {{> storage}}
        </div>
        <div class="left gui-window">
            {{> uiBooks}}
        </div>
        <div class="left gui-window">
            {{> map}}
        </div>
    </div>
</template>

<template name="uiWalking">
    <h4>Walking</h4>
    <p>Location: {{currentUser.location}}</p>
    <p>{{encounter}}</p>
    <button class="action" action="west">{{west}}</button>
    <button class="action" action="east">{{east}}</button>
    <button class="action" action="north">{{north}}</button>
    <button class="action" action="south">{{south}}</button>
    <button class="action" action="read">Read a book</button>
    <button class="action" action="camp">Make camp</button>
</template>

<template name="uiCamping">
    <h4>Camping</h4>
    <button class="action" action="eat">Eat</button>
    <button class="action" action="drink">Drink</button>
    <button class="action" action="read">Read a book</button>
    <button class="action" action="fire">Create fire</button>
    <button class="action" action="dirt">Dig up some dirt</button>
    <button class="action" action="break">Break camp</button>
    <p>{{ campingAction }}</p>
</template>

<template name="uiCharacter">
    <h4>Character</h4>

    <div class="float">
        <div class="left list">
            <b>Health</b>
            <ul>
                <li>Hunger: {{currentUser.health.hunger}}</li>
                <li>Thirst: {{currentUser.health.thirst}}</li>
            </ul>
            <ul>
                <li>Mind: {{currentUser.health.mind}}</li>
                <li>Head: {{currentUser.health.head}}</li>
                <li>Torso: {{currentUser.health.torso}}</li>
                <li>Left arm: {{currentUser.health.leftArm}}</li>
                <li>Right arm: {{currentUser.health.rightArm}}</li>
                <li>Left leg: {{currentUser.health.leftLeg}}</li>
                <li>Right leg: {{currentUser.health.rightLeg}}</li>
            </ul>
        </div>
        <div class="left list">
            <b>Equipment</b>
            <ul>
                <li>Head: {{currentUser.equipment.head}}</li>
                <li>Body: {{currentUser.equipment.body}}</li>
                <li>Hands: {{currentUser.equipment.hands}}</li>
                <li>Feet: {{currentUser.equipment.feet}}</li>
            </ul>
        </div>
        <b>Total skills: {{totalSkills}}</b>
        <div class="left list">
            <b>Physical Skills</b>
            <ul>
                {{#each physicalSkills}}
                    <li>{{label}}: {{value}}</li>
                {{/each}}
            </ul>
        </div>
        <div class="left list">
            <b>Mental Skills</b>
            <ul>
                {{#each mentalSkills}}
                    <li>{{label}}: {{value}}</li>
                {{/each}}
            </ul>
        </div>
        <div class="left list">
            <b>Weapon Skills</b>
            <ul>
                {{#each weaponSkills}}
                    <li>{{label}}: {{value}}</li>
                {{/each}}
            </ul>
        </div>
        <div class="left list">
            <b>Spell Skills</b>
            <ul>
                {{#each spellSkills}}
                    <li>{{label}}: {{value}}</li>
                {{/each}}
            </ul>
        </div>
        <div class="left list">
            <b>Crafting Skills</b>
            <ul>
                {{#each craftingSkills}}
                    <li>{{label}}: {{value}}</li>
                {{/each}}
            </ul>
        </div>
    </div>
</template>

<template name="uiBooks">
    <h4>Books</h4>

    {{#if reading}}
        <p>Reading: {{reading.book}} {{reading.progress}}/10</p>
        <p>Time left: {{timeLeft}}</p>
    {{/if}}

    {{#each books}}
        <div class="book">
            {{id}} <button class="read" book="{{id}}">Read</button>
        </div>
    {{/each}}
    <p>Have read: {{currentUser.books.read}}</p>
</template>

<template name="uiInventory">
    <h4>Inventory</h4>
</template>

<template name="uiBattle">
    <h4>Battle</h4>
</template>

<template name="uiTown">
    <h4>Town</h4>
</template>

<template name="uiDialog">
    <h4>Dialog</h4>
</template>

<template name="map">
    <h4>Map</h4>
    <p>Location: {{location}}</p>

    <table class="map">
    {{#each rows}}
        <tr class="map-row">
        {{#each .}}
            <td class="loc {{biome}}" loc="{{loc}}"></td>
        {{/each}}
        </tr>
    {{/each}}
    </table>
</template>

<template name="combat">
    <h4>Combat</h4>

    {{#with combat}}
    <small>#{{_id}}</small>

    <div class="combat float">
        <div class="party">
            {{#each party}}
                <div class="party-member">
                    <b>{{name}}</b>
                    <div class="bar-container">
                        <div class="bar red" style="width: {{health.head}}%">
                            <span>Head</span>
                        </div>
                    </div>
                    <div class="bar-container">
                        <div class="bar red" style="width: {{health.torso}}%">
                            <span>Torso</span>
                        </div>
                    </div>
                    <div class="bar-container">
                        <div class="bar red" style="width: {{health.leftArm}}%">
                             <span>Left Arm</span>
                        </div>
                    </div>
                    <div class="bar-container">
                        <div class="bar red" style="width: {{health.rightArm}}%">
                             <span>Right arm:</span>
                        </div>
                    </div>
                    <div class="bar-container">
                        <div class="bar red" style="width: {{health.leftLeg}}%">
                             <span>Left Leg</span>
                        </div>
                    </div>
                    <div class="bar-container">
                        <div class="bar red" style="width: {{health.rightLeg}}%">
                             <span>Right Leg</span>
                        </div>
                    </div>
                </div>
            {{/each}}
        </div>

        <div class="log">
            <h4>Combat Log</h4>
        </div>

        <div class="enemies">
        {{#each enemy}}
            <div class="enemy">
                <b>{{name}}</b>

                {{#each toArray health}}
                <div class="bar-container">
                    <div class="bar red" style="width: {{value}}%">
                        <span>{{key}}</span>
                    </div>
                </div>
                {{/each}}
            </div>
        {{/each}}
        </div>
    </div>
    {{/with}}
</template>